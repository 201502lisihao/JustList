<!--index.wxml-->
<view class="page">
    <scroll-view scroll-y="true" style="height:{{usefulWindowHeight}}px">
      <!-- 顶部状态栏 -->
      <view class="top-bar">
        <view class="aTitle">
          <view class="page_title">一个管理 to-do list 的小工具</view>
          <view class="page_desc"><text style="color:#d3d3d3;font-size:24rpx">design by lisihao</text></view>
          <!-- <text style="font-size:30rpx;margin-right:24rpx;">一个管理 to-do list 的小工具</text><text style="color:#d3d3d3;font-size:24rpx">design by lisihao</text> -->
        </view>
        <view class="user">
                  <button wx:if="{{!hasUserInfo && canIUse}}" open-type="getUserInfo" bindgetuserinfo="getUserInfo" class="login">Login</button>
                  <block wx:else>
                    <image bindtap="openConfirm" class="userinfo-avatar" src="{{userInfo.avatarUrl}}" mode="cover"></image>
                    <!-- <text class="userinfo-nickname">{{userInfo.nickName}}</text> -->
                  </block>
        </view>
      </view>
      <view wx:if="{{hasItem}}" class="content">
              <!-- 展示待办事项 -->
              <view wx:if="{{todoList}}">
                <block id="todolist" wx:for="{{todoList}}">
                  <view class="card">
                    <view class="weui-cells">
                      <view class="weui-cell">
                        <!-- 删除 -->
                        <view class="weui-cell__hd">
                          <image src="/images/del.png" style="width:40rpx;height:40rpx;margin-right:20rpx;padding-top:12rpx;" bindtap="deleteItem" data-id="{{item.id}}"></image>
                        </view>
                        <!-- 内容 -->
                        <view class="weui-cell__bd">{{item.title}}</view>
                        <!-- 标记完成 -->
                        <view class="weui-cell__ft">
                          <image src="/images/undo.png" style="width:40rpx;height:40rpx;margin-right:20rpx;padding-top:12rpx;" bindtap="doToDone" data-id="{{item.id}}"></image>
                        </view>
                      </view>
                    </view>
                  </view>
                </block>
              </view>
              <!-- 展示已完成事项 -->
              <view wx:if="{{doneList}}">
                <block id="donelist" wx:for="{{doneList}}">
                  <view class="card">
                    <view class="weui-cells weui-cells-done">
                      <view class="weui-cell weui-cell-done">
                        <!-- 删除 -->
                        <view class="weui-cell__hd">
                          <image src="/images/del.png" style="width:40rpx;height:40rpx;margin-right:20rpx;padding-top:12rpx;" bindtap="deleteItem" data-id="{{item.id}}"></image>
                        </view>
                        <!-- 内容 -->
                        <view class="weui-cell__bd">{{item.title}}</view>
                        <!-- 标记完成 -->
                        <view class="weui-cell__ft">
                          <image src="/images/done.png" style="width:40rpx;height:40rpx;margin-right:20rpx;padding-top:12rpx;" bindtap="doneToDo" data-id="{{item.id}}"></image>
                        </view>
                      </view>
                    </view>
                  </view>
                </block>
              </view>
      </view>
      <!-- 无待办事项时给一个默认样式 -->
      <view wx:else class="welcome_style" style="height:{{usefulWindowHeight-70}}px">
        <image src="/images/404-1.png" class="welcome_img"></image>
        <image src="/images/404-2.png" class="welcome_img"></image>
        <image src="/images/404-3.png" class="welcome_img"></image>
        <image src="/images/404-4.png" class="welcome_img"></image>
        <image src="/images/404-5.png" class="welcome_img"></image>
      </view>
    </scroll-view>
    <!-- 底部操作栏 -->
    <view class='cut-bar' wx:if="{{errorMsg}}">
      <label>{{errorMsg}}</label>
    </view>
    <view id="operate-bar" class="operate-bar">
      <input class="addTodoInput" type="text" placeholder="Add to-do.." placeholder-class="placeholder" value="{{adding}}" confirm-type="done" bindconfirm="addTodo"></input>
    </view>
</view>